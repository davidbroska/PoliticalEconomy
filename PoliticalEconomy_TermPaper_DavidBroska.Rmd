---
title: "Evidence from the Arabic Spring"
author: "David Broska"
abstract: "Is there empirical evidence for Acemoglu and Robinson's model from the Arabic Spring? More precisely, under which conditions does inquality predict a revolution? The analyses will present an overview of the outcomes of the revolution."
date: "`r Sys.Date()`"
output: 
  pdf_document: 
    number_sections: true
bibliography: bib.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
# install.packages("tidyverse")
# install.packages("rvest") # will also install required package xml2
# install.packages("lubridate")
# install.packages("wesanderson")
library(tidyverse); library(lubridate); library(wesanderson)
```

# Introduction: Revolution and Inequality

"Acemoglu and Robinson [-@acemoglu2006origins] develop framework for analyzing the creation and consolidation of democracy. Different social groups prefer different political institutions because of the way they allocate political power and resources. Thus democracy is preferred by the majority of citizens, but opposed by elites. Dictatorship nevertheless is not stable when citizens can threaten social disorder and revolution. In response, when the costs of repression are sufficiently high and promises of concessions are not credible, elites may be forced to create democracy. By democratizing, elites credibly transfer political power to the citizens, ensuring social stability. Democracy consolidates when elites do not have strong incentive to overthrow it. These processes depend on (1) the strength of civil society, (2) the structure of political institutions, (3) the nature of political and economic crises, (4) the level of economic inequality, (5) the structure of the economy, and (6) the form and extent of globalization."

This article focusses on the fourth aspect: the level of economic inquality. 

-> mention no evidence for the relation of increasing income and changes in democracy

# Revolution constraint

If the fraction of what will be destroyed in a revolution is larger than the share of the income of the rich, the tax rate will be zero and there will not be a revolution.

If the fraction of what will be destroyed in a revolution is smaller than the share of income of the rich and this fraction is smaller than what the poor will get when the elite employs a tax rate according to the preferences of the poor, there still will be a revolution.

If the fraction of what will be destroyed in a revolution is smaller than the share of income of the rich and this fraction is larger than what the poor will get when the elite employs a tax rate according to the preferences of the poor, the elite will employ a tax rate that prevents a revolution and therefore, there will only be a revolution if that tax rate is lower than the one preferred by the poor and there will not be a revolution if the elite employs a tax rate that is higher/equal to the tax rate preferred by the poor.

# Does the degree of inequality correspond the severeness of revolutionary movements?

In the model of Acemoglu and Robinson [-@acemoglu2006origins] inter-group inequality and revolutions are related by the possible outcomes of a regime-critical movement. In non-democracies citizens obtain only a small fraction of available resources. With a revolution there is a chance the share the income of the economy minus the what is destroyed. There is a lack of useful estimate of the fraction of what will be destroyed in a revolution. However, we can still examine a major result of the result with respect to the Arabic Spring: Inequality is as main driver of revolution. We can relate this conclusion to the severeness of regime-critical movements. In other words: The higher the inequality, the stronger the opposition.

- Moreover, they assume that the inter-group inequality is related to the set of political institutions because an effective thread of revolution initiates the democratization process. Democratization implies a higher influence of the people on the redistribution of the income of an economy. It follows that democratization is attractive for citizens and costly for the elites. In this sense Acomoglu and Robinson emphasize social conflicts between groups as driving force of democratization.


```{r costum functions}
tidy_worldbank_data <- function(.dataframe){
  
  df <- .dataframe %>% 
    rename_all(~ str_replace(., ' ', '_') %>% str_remove('[0-9]{4}_\\[YR') %>% str_remove('\\]$')) %>% 
    mutate(Country_Name = Country_Name %>% str_remove("(n )?(, )?(Arab )?Rep.(blic)?")) %>% 
    select(Country_Name, matches('[0-9]{4}')) %>% 
    na_if('..') %>% 
    mutate_at(vars(matches('[0-9]{4}')), as.numeric) %>%
    gather(Year, value, - Country_Name) %>% 
    mutate(Year = paste(Year, "-01-01") %>% lubridate::ymd())
  
  return(df)
}

# define x and y coordinates of plot according to the time of the event
plot_worldbank_data <- function(.dataframe){
  
  arab_countries <- data_frame(
    # countries mentioned in the context of arab spring 
    countries = c("Egypt", "Tunisia", "Jordan", "Yemen", "Bahrain", "Libya", "Syria", "Morocco"), 
    # costum colors for plot
    colours =  c(wes_palette("Darjeeling1"), wes_palette("Darjeeling2")[1:3])
  )

  # prepare dataframe to
  more1_observation <- .dataframe %>%
    filter(str_detect(Country_Name, paste0(arab_countries$countries, collapse = "|")), 
           !is.na(.dataframe[3])) 
  
  plot_coordinates <- data_frame(
    xmin = min(timeline$Date),
    xmax = max(timeline$Date),
    ymin = min(more1_observation[3], na.rm = T),
    ymax = max(more1_observation[3], na.rm = T)
  )
  
  # indicate area of major events of arab spring in plot
  aesthetic_layers <- list(
    geom_rect(inherit.aes = F,
              data = plot_coordinates,
              fill = "red",
              alpha = 0.2,
              mapping = aes(xmin = xmin, xmax = xmax,
                            ymin = ymin, ymax = ymax)),
    geom_text(inherit.aes = F,
              aes(x = xmin + (xmax - xmin) / 2, y = ymin),
              label = "Major Events of Arab Spring",
              angle = 90, vjust = 0.36, size = 3.1, hjust = -0.5,
              data = plot_coordinates,
              alpha = 0.7),
    xlab("Year"),
    labs(color = "Country"),
    theme_minimal(),
    scale_x_date(limits = c(as.Date("1990-01-01"), as.Date("2016-01-01")),
                 labels = scales::date_format("%Y"),
                 breaks = '2 years'), 
    scale_colour_manual(values = setNames(as.character(arab_countries$colours), 
                                        arab_countries$countries))
  )
  
  
  plot <- ggplot(more1_observation,
                 aes_string(x = "Year", y = names(.dataframe[3]), color = "Country_Name")) +
    geom_point() +
    geom_line() +
    aesthetic_layers 
  
  return(plot)
  
} 

```

```{r get wikipedia data, eval=FALSE}
# download infobox from wikipedia that provides a timeline of major events 
timeline <- xml2::read_html('https://fr.wikipedia.org/wiki/Printemps_arabe') %>% 
  rvest::html_nodes(xpath = "//div[@class='infobox_v3']/table") %>% 
  map(~ rvest::html_table(., fill = T)) %>% 
  `[[`(2) 

# save file  
# saveRDS(wiki_infobox, paste0("wiki_fr_timeline", Sys.Date(), ".rds")) 
```

```{r load data, message=F}
# wikipedia data on major events of the Arab Spring
timeline <- readRDS("wiki_fr_timeline2018-11-08.rds") %>% 
  rename(Date = X1, Event = X2) %>% 
  mutate(Date = lubridate::dmy(Date, locale = "fr_FR"), 
         Event = Event %>% str_remove('Début d[ue] (l[ae])?'))

# load and prepare world bank data with costum function 
taxes_on_income_profits_capital <- read_csv("Taxes_on_income_profits_and_capital_gains_percent_of_revenue/0d52d1bc-db61-47c7-93d3-ee204c304426_Data.csv") %>% 
  tidy_worldbank_data() %>% 
  rename(taxes_on_income_profits_capital = value)

other_taxes <- read_csv("Other_taxes_percent_of_revenue/9b158b9f-a3eb-47e6-8af9-d96474fed701_Data.csv") %>% 
  tidy_worldbank_data() %>% 
  rename(other_taxes = value)

costums_and_import_duties <- read_csv("Costums_and_other_import_duties_percent_of_tax_revenue/baee911a-96eb-4e8b-8b87-210625131ecc_Data.csv") %>% 
  tidy_worldbank_data() %>% 
  rename(costums_and_import_duties = value)

taxes_on_international_trade <- read_csv("Costums_and_other_import_duties_percent_of_tax_revenue/baee911a-96eb-4e8b-8b87-210625131ecc_Data.csv") %>% 
  tidy_worldbank_data() %>% 
  rename(taxes_on_international_trade = value)

gini <- read_csv("world_bank_gini/63230575-efbf-45e6-9b9b-af6357c55121_Data.csv") %>% 
  tidy_worldbank_data() %>% 
  rename(gini = value)

```

```{r plot gini coefficient over years with major events}
plot_worldbank_data(gini) + ylab("Gini Coefficient")
```

```{r plot other taxes}
plot_worldbank_data(other_taxes) + ylab("Other Taxes")
```

```{r plot taxes on income profits and capital gains}
plot_worldbank_data(taxes_on_income_profits_capital) + ylab("Taxes on Income Profits and Capital Gains")
```

```{r plot taxes on international trade}
plot_worldbank_data(taxes_on_international_trade) + ylab("Taxes on International Trade")
```



Context: 

- Timur Kuran [@kuran2004] discusses the question why the Middel East is relatively underdeveloped in the context of institutions
- The introduction of "Why Nations Fail" [@acemoglu2012nations] provides a compact summary of the main events of Egypt's Arabic spring

Case Study: 

- "The Power of the Street: Evidence from Egypt’s Arab Spring" is an empirical investigation of the question how change in political power affects economic outcomes [@acemoglu2018arabic].



# References